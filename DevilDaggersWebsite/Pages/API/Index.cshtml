@page
@model DevilDaggersWebsite.Pages.API.IndexModel
@using DevilDaggersWebsite.Models.API
@using DevilDaggersWebsite.Utils
@using DevilDaggersCore.Game
@using NetBase.Extensions
@using System.Reflection
@{
	ViewData["Title"] = "API Overview";
}

<h1>@ViewData["Title"]</h1>

<main role="main">
	<p class="text-center">
		These are all API functions available. Only GET parameters are supported for now. The functions are currently used in the client-side section of the website and also in <a href="Tools#DevilDaggersSurvivalEditor">DevilDaggersSurvivalEditor</a>, but feel free to use them for any tool or application you've made yourself. This table is automatically generated, so it will always be up to date.
	</p>

	<h2>List of functions</h2>
	<div class="api-list">
		<div class="row text-bold">
			<div class="col-lg-2 col-md-2 col-sm-3 col-xs-3">Name</div>
			<div class="col-lg-4 col-md-6 col-sm-9 col-xs-9">Description</div>
			<div class="col-lg-2 col-md-2 hidden-sm hidden-xs">Return type</div>
			<div class="col-lg-2 col-md-2 hidden-sm hidden-xs">Parameters</div>
			<div class="col-lg-2 hidden-md hidden-sm hidden-xs">Optional parameters</div>
		</div>

		@{
			List<ApiFunction> allFunctions = Model.ApiFunctions.Concat(Model.ApiFunctionsDeprecated).ToList();
			int i = 0;
			foreach (ApiFunction api in allFunctions)
			{
				List<string> parameters = new List<string>();
				List<string> optionalParameters = new List<string>();
				foreach (ParameterInfo pInfo in api.Parameters)
				{
					if (pInfo.IsOptional)
					{
						optionalParameters.Add(pInfo.Name);
					}
					else
					{
						parameters.Add(pInfo.Name);
					}
				}
				<div class="row" style="@(i % 2 == 0 ? "background-color: #111;" : "")">
					<div class="col-lg-2 col-md-2 col-sm-3 col-xs-3"><a asp-page=@api.Name class="dont-break-out">@api.Name</a></div>
					<div class="col-lg-4 col-md-6 col-sm-9 col-xs-9">@api.FormattedDescription</div>
					<div class="col-lg-2 col-md-2 hidden-sm hidden-xs">@api.Attribute.ReturnType</div>
					<div class="col-lg-2 col-md-2 hidden-sm hidden-xs api-parameter">@(parameters.Count != 0 ? Html.Raw(string.Join(", ", parameters)) : RazorUtils.NAString)</div>
					<div class="col-lg-2 hidden-md hidden-sm hidden-xs api-parameter-optional">@(optionalParameters.Count != 0 ? Html.Raw(string.Join(", ", optionalParameters)) : RazorUtils.NAString)</div>
				</div>
				i++;
			}
		}
	</div>

	<h2>Examples</h2>
	<div class="api-list">
		<div class="row text-bold">
			<div class="col-xs-4">
				Example
			</div>
			<div class="col-xs-8">
				Result
			</div>
		</div>
		<div class="row" style="background-color: #111;">
			<div class="col-xs-4">
				<a asp-page="GetSpawnsets" asp-route-searchAuthor="Sorath" asp-route-searchName="V" class="dont-break-out">API/GetSpawnsets?searchAuthor=Sorath&searchName=V</a>
			</div>
			<div class="col-xs-8">
				Returns the result(s) for every spawnset that contains "Sorath" in the spawnset's author and "V" in the spawnset's name.
			</div>
		</div>
		<div class="row">
			<div class="col-xs-4">
				<a asp-page="GetDeaths" asp-route-deathType="10" asp-route-formatted="true" class="dont-break-out">API/GetDeaths?deathType=10&formatted=true</a>
			</div>
			<div class="col-xs-8">
				Returns the Death object for the deathType 10 which is <span style='color: #@Game.V3.Annihilated.ColorCode'>@Game.V3.Annihilated.Name</span>, and also formats the JSON.
			</div>
		</div>
		<div class="row" style="background-color: #111;">
			<div class="col-xs-4">
				<a asp-page="GetSpawnset" asp-route-fileName="V3_Sorath" class="dont-break-out">API/GetSpawnset?fileName=V3_Sorath</a>
			</div>
			<div class="col-xs-8">
				Returns the spawnset with the name "V3_Sorath".
			</div>
		</div>
	</div>
</main>

@section Styles {
	<link rel='stylesheet' href='~/styles/api.css' />
}