@page "/WorldRecordProgression"
@inject LeaderboardHistoryHelper _leaderboardHistoryHelper

@if (_isLoading)
{
	<LoadingState />
}
else
{
	<DxChart Data="@_worldRecords">
		<DxChartCommonSeries NameField="@((WorldRecord wr) => GameInfo.GetGameVersionFromDate(wr.DateTime))" ArgumentField="@(wr => wr.DateTime)" ValueField="@(wr => wr.Entry.Time / (float)10000)" SeriesType="@ChartSeriesType.StepLine" />
	</DxChart>
}

@code
{
	private List<WorldRecord> _worldRecords = new();

	private bool _isLoading;

	protected override async Task OnInitializedAsync()
	{
		_isLoading = true;
		_worldRecords = await Task.Run(() => _leaderboardHistoryHelper.GetWorldRecords(null));
		_isLoading = false;
	}
}
