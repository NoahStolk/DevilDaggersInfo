@page "/leaderboard/history"
@inject PublicApiHttpClient Http
@inject NavigationManager NavigationManager
@using DevilDaggersInfo.Core.Wiki
@using DevilDaggersInfo.Core.Wiki.Enums
@using DevilDaggersInfo.Web.BlazorWasm.Client.Components.Leaderboards
@using DevilDaggersInfo.Web.BlazorWasm.Client.Components.Leaderboards.History
@using DevilDaggersInfo.Web.BlazorWasm.Shared.Dto.Public
@using DevilDaggersInfo.Web.BlazorWasm.Shared.Dto.Public.LeaderboardHistory
@using DevilDaggersInfo.Web.BlazorWasm.Shared.Dto.Public.Players

@if (GetLeaderboardHistory == null)
{
	<Loading />
}
else
{
	<Heading Title="@($"Leaderboard History - {GetLeaderboardHistory.DateTime.ToString(FormatUtils.DateTimeFormat)}")" />
	
	@if (_reloading)
	{
		<Loading />
	}
	else if (!DatesEqual(GetLeaderboardHistory.DateTime, _dateTime))
	{
		<i>History for @(_dateTime.ToString(FormatUtils.DateTimeFormat)) does not exist; falling back to @GetLeaderboardHistory.DateTime.ToString(FormatUtils.DateTimeFormat).</i>
	}

	<DatePicker DateSelected="@(d => UpdateDateTime(d))" />

	<LeaderboardGlobal Leaderboard="GetLeaderboardHistory" IsHistory="true" />
	<LeaderboardTableInfo />
	<LeaderboardTable TGetEntryDto="GetEntryHistory" Entries="GetLeaderboardHistory.Entries" Players="Players" IsHistory="true" GameVersion="_gameVersion" />
}
