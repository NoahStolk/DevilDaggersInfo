@page
@using DevilDaggersWebsite.Razor.Utils
@using DevilDaggersCore.Game
@using DevilDaggersWebsite.Enumerators
@model DevilDaggersWebsite.Razor.Pages.CustomLeaderboards.LeaderboardModel
@{
	string name = Model.SpawnsetFile?.Name ?? throw new Exception("Spawnset was null in CustomLeaderboards/Leaderboard page.");
	ViewData["Title"] = $"Leaderboard for {name} by {Model.SpawnsetFile.Player.PlayerName}";

	List<(string DaggerName, string DisplaySeconds)> daggerInfo = new();
	for (int i = 0; i < 5; i++)
	{
		daggerInfo.Add(Model.GetDaggerInfo(i));
	}
}

<header>
	<h1 class="dont-break-out">@ViewData["Title"]</h1>
</header>

<main role="main">
	<div class="text-center">
		<p>
			<a asp-page="/Spawnset" asp-route-spawnset="@Model.SpawnsetFile.Name">Spawnset page for @name</a>
		</p>

		@{
			if (!string.IsNullOrEmpty(Model.SpawnsetFile.HtmlDescription))
			{
				<div class="description">
					@RazorUtils.GetLayout(Model.SpawnsetFile.HtmlDescription, GameVersion.V31)
				</div>
			}
		}

		<div class="hidden-xs text-center">
			<div class="flex-container flex-center flex-space-evenly" style="margin: 12px;">
				@for (int i = 0; i < 5; i++)
				{
					(string daggerName, string seconds) = daggerInfo[i];

					<div>
						<div><img src="~/Images/Daggers/@(daggerName)Small.png" /></div>
						<div class="@daggerName.ToLower() text-center" style="width: 100%;">@seconds</div>
					</div>
				}
			</div>
		</div>
		<div class="visible-xs">
			<div class="flex-container flex-center">
				<div class="mobile-left" style="padding-right: 8px;">
					@for (int i = 0; i < 5; i++)
					{
						(string daggerName, _) = daggerInfo[i];

						<div>@daggerName</div>
					}
				</div>
				<div class="mobile-right" style="padding-left: 8px;">
					@for (int i = 0; i < 5; i++)
					{
						(string daggerName, string displaySeconds) = daggerInfo[i];

						<div class="@daggerName.ToLower() text-right">@displaySeconds</div>
					}
				</div>
			</div>
		</div>

		<p class="visible-xs visible-sm visible-md">
			On mobile devices; tap on an entry to expand it.
		</p>
		<p>
			You can sort the leaderboard by clicking the headers.
		</p>
	</div>
	@await Html.PartialAsync($"Partials/_LeaderboardCustomDefaultPartial")
</main>

@section Scripts {
	<script defer src='~/scripts/leaderboard-user-custom.js' asp-append-version='true'></script>
}

@section Styles {
	<link rel='stylesheet' href='~/styles/leaderboard.css' />
	@if (Model.Leaderboard!.Category == CustomLeaderboardCategory.Challenge)
	{
		<link rel='stylesheet' href='~/styles/leaderboard-rows-custom-challenge.css' />
	}
	else
	{
		<link rel='stylesheet' href='~/styles/leaderboard-rows-custom-default.css' />
	}
}
