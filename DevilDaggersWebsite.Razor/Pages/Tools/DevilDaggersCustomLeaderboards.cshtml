@page
@inject Microsoft.AspNetCore.Hosting.IWebHostEnvironment env
@inject Transients.ToolHelper toolHelper
@using DevilDaggersCore.Utils
@using DevilDaggersWebsite.Dto
@using System.IO
@{
	Tool tool = toolHelper.GetToolByName("DevilDaggersCustomLeaderboards");
	ViewData["Title"] = tool.DisplayName;
	string downloadFileName = $"{tool.Name}{tool.VersionNumber}.zip";
	FileInfo downloadFileInfo = new(System.IO.Path.Combine(env.WebRootPath, "tools", tool.Name, downloadFileName));
	const string runtimeUrl = "https://dotnet.microsoft.com/download/dotnet/5.0";
	const string runtimeName = ".NET Runtime 5.0.x";
	const string desktopRuntimeName = ".NET Desktop Runtime 5.0.x";
}

<header>
	<h1>@ViewData["Title"]</h1>
</header>

<main role="main">
	<p>
		Devil Daggers Custom Leaderboards is a program that records data from custom spawnset runs, and uploads it to a <a asp-page="/CustomLeaderboards/Index">custom leaderboard</a>.
	</p>

	<p>
		<img class="img-responsive image-narrow ddcl-image" src="~/images/Tools/@(tool.Name).png" />
	</p>

	<p>
		Current version: @(tool.VersionNumber)<br />
		Oldest supported version: @(tool.VersionNumberRequired)<br />
		File size: @(Math.Round(downloadFileInfo.Length / 1024f).ToString()) KB<br />
		<a class="btn dont-break-out" href="/api/tools/@tool.Name/file">Download</a>
	</p>

	<h2>System requirements</h2>
	<ul>
		<li>Microsoft Windows</li>
		<li><a href="@runtimeUrl">@runtimeName</a></li>
		<li>The Steam version of Devil Daggers</li>
	</ul>

	<h2>Installation</h2>
	<ol>
		<li>Make sure to install <a href="@runtimeUrl">@runtimeName</a>. If you already have the @desktopRuntimeName used for the survival and asset editors, you can skip this step.</li>
		<li>Download the .zip file.</li>
		<li>Unzip its contents.</li>
		<li>Run the executable (.exe file) inside the folder.</li>
	</ol>

	<h2>Source code</h2>
	<p>
		The source code can be found on <a target="_blank" href="@UrlUtils.SourceCodeUrl(tool.Name)">GitHub</a>.
	</p>

	<h2>Changelog</h2>
	@tool.ToChangelogHtmlString()
</main>

@section Styles {
	<link rel='stylesheet' href='~/styles/tools.css' />
}
